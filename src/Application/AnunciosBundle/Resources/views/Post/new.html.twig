{% extends "ApplicationAnunciosBundle::layout.html.twig" %}
{% form_theme form 'ApplicationAnunciosBundle:Form:fields.html.twig' %}

{% block title "Publicar anuncio" %}

{% block content %}

<h1>Publicar anuncio</h1>

<style>
TEXTAREA.xlarge{width:430px}
#application_anunciosbundle_posttype_type label{float:none;margin:0 20px 0 5px}
</style>

{% if app.session.get('id') %}

<form action="{{ path('post_create') }}" method="post" {{ form_enctype(form) }}>

	{{ form_errors(form) }}


	{{ form_row(form.type, { 'label': 'Tipo' }) }}

	
	<div class="clearfix">
		<label>Perfil</label>
		<div class="input">
			<select id="application_anunciosbundle_posttype_category_id" name="application_anunciosbundle_posttype[category_id]">
				{% for category in categories %}
					{% if loop.index0 > 0 %}
						<option value="{{loop.index0}}">{{category}}</a>
					{% endif %}
				{% endfor %}
			</select>
		</div>
	</div>

	{{ form_row(form.title, { 'label': 'Titulo' }) }}
	
	{{ form_row(form.body, { 'label': 'Descripción' }) }}
	
	{{ form_row(form.email, { 'label': 'Email' }) }}
	
	<div id="price" {% if entity.type == 2 %}style="display:none"{% endif %}>
		{{ form_row(form.price, { 'label': 'Sueldo' }) }}
	</div>
	
	<div id="nolocation" class="clearfix">
		<label></label>
		<div class="input">
			<input type="checkbox" id="chk_location"/> <label for="chk_location" style="float:none">¿Es un trabajo presencial?</label>
		</div>
	</div>
	<div id="geo">
		{{ form_row(form.location, { 'label': 'Localización' }) }}
		<div class="hide">
			{{ form_row(form.country_id, { 'label': 'country' }) }}
			{{ form_row(form.city_id, { 'label': 'city' }) }}
		</div>
	</div>



	<div class="actions">
        <button type="submit" class="btn primary">Publicar</button>
	</div>

	{{ form_row(form._token) }}

</form>

{% else %}
	Area restringida, solo accesible para usuarios
{% endif %}

{% endblock %}

{% block script_load %}
	
autoGeo();

// post type
$('#application_anunciosbundle_posttype_type input:eq(0)').click(function(){
	$('#price').show();
});
$('#application_anunciosbundle_posttype_type input:eq(1)').click(function(){
	$('#price').show();
});
$('#application_anunciosbundle_posttype_type input:eq(2)').click(function(){
	$('#price').hide();
	$('#price input:first').val('');
});
{% if entity.type == 2 %}
	$('#price').hide();
{% endif %}


// need location?
$('#chk_location').click(function(){
	if( $(this).attr('checked') ){
		$('#geo').show();
		$('#geo input:first').focus();
	}else{
		$('#geo').hide();
		$('#geo input:first').val('');
	}
});


{% if entity.location == '' %}
	$('#geo').hide();
{% else %}
	$('#chk_location').attr('checked','checked');
{% endif %}


{% endblock %}